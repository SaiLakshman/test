This chaincode is after the changes discussed on july 2

